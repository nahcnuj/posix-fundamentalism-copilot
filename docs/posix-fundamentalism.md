# POSIX原理主義

## POSIX原理主義とは

[松浦リッチー研究所](https://richlab.org) が提唱するソフトウェア開発の哲学で、[POSIX](https://pubs.opengroup.org/onlinepubs/9699919799/) 標準に厳密に準拠した開発を行うことを基本とする。

> 参照: [POSIX原理主義 - SlideShare](https://www.slideshare.net/slideshow/posix-59780910/59780910)

## 基本原則

### 1. 万物はファイルである

- ファイル、デバイス、パイプ、ソケットなど、すべてをファイル（ストリーム）として抽象化する
- この統一的な抽象化がプログラムの組み合わせを可能にする

### 2. 一つのことをうまくやる（Do one thing and do it well）

- 各プログラム・コマンド・関数は一つのことだけを行い、それをうまくやる
- 複数の役割を持たせない

### 3. テキストストリームをユニバーサルインターフェースとして使う

- プログラム間のやりとりにはテキスト（改行区切りなど）を使う
- バイナリ形式ではなく人間が読めるテキスト形式で入出力を行う

### 4. プログラムを組み合わせる

- パイプ（`|`）を使って小さなプログラムを組み合わせ、より大きなタスクを実現する
- 再利用可能で組み合わせ可能な部品として設計する

### 5. POSIX 標準に厳密に準拠する

- POSIX で定義された機能・インターフェースのみを使用する
- GNU 拡張・bash 拡張・macOS 固有機能など、非標準の拡張機能は使用しない
- 特定のシェル（bash, zsh など）の固有機能に依存しない

### 6. 移植性（Portability）を確保する

- 任意の POSIX 準拠システム（Linux, macOS, FreeBSD など）で動作するコードを書く
- OS やディストリビューションに依存しないコードを目指す

## 実践ガイドライン

### シェルスクリプト

- シバン（shebang）は `#!/bin/sh` を使用する（`#!/bin/bash` は使用しない）
- bash・zsh・ksh などの固有機能（配列、`[[...]]`、プロセス置換など）は使用しない
- `sh` の POSIX 準拠モードで動作することを確認する

### コマンド・ツール

- POSIX 標準のオプション・引数のみ使用する
- GNU 固有のオプション（`grep -P`, `sed -i` の動作差異など）に依存しない
- `awk`, `sed`, `grep` などは POSIX 標準の範囲で使用する

### プログラミング

- POSIX API（`<unistd.h>`, `<fcntl.h>`, `<sys/stat.h>` など）を使用する
- プラットフォーム固有の API は使用しない

## まとめ

POSIX 原理主義とは、特定の OS やツール実装に依存せず、POSIX 標準という共通の基盤の上に立ってソフトウェアを開発する姿勢である。これにより、ソフトウェアの移植性・保守性・信頼性が向上する。
